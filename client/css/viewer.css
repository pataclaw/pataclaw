* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0a0a0a;
  color: #33ff33;
  font-family: 'Courier New', Courier, monospace;
  overflow: hidden;
  height: 100vh;
  width: 100vw;
  transition: background 3s ease;
}

#app {
  display: flex;
  height: calc(100vh - 32px);
}

#scene-container {
  flex: 1;
  overflow: hidden;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

#world {
  white-space: pre;
  font-size: 12px;
  line-height: 1.15;
  padding: 8px 12px;
  text-shadow: 0 0 4px rgba(51, 255, 51, 0.15);
  transition: color 3s ease, text-shadow 3s ease;
}

/* Sidebar */
#sidebar {
  width: 250px;
  background: #0d0d0d;
  border-left: 1px solid #222;
  overflow-y: auto;
  font-size: 11px;
  flex-shrink: 0;
  transition: background 3s ease;
  scrollbar-width: thin;
  scrollbar-color: #333 #0d0d0d;
}

#sidebar::-webkit-scrollbar { width: 4px; }
#sidebar::-webkit-scrollbar-track { background: #0d0d0d; }
#sidebar::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }

#town-info {
  padding: 12px;
  border-bottom: 1px solid #222;
  text-align: center;
}

.info-header {
  color: #ffcc00;
  font-size: 14px;
  font-weight: bold;
  letter-spacing: 2px;
}

.info-sub { color: #666; font-size: 10px; margin-top: 4px; }
.info-motto { color: #557755; font-size: 10px; margin-top: 4px; font-style: italic; }
.info-culture { color: #ff66ff; font-size: 10px; margin-top: 4px; letter-spacing: 1px; }

.panel {
  padding: 8px 12px;
  border-bottom: 1px solid #1a1a1a;
}

.panel-title {
  color: #888;
  font-size: 10px;
  letter-spacing: 3px;
  margin-bottom: 6px;
  border-bottom: 1px solid #1a1a1a;
  padding-bottom: 4px;
}

.panel-title::before {
  content: '> ';
  color: #555;
}

.panel-title span { float: right; color: #ffcc00; }

/* Resources */
.res-row {
  display: flex;
  align-items: center;
  gap: 4px;
  margin-bottom: 3px;
  font-size: 10px;
}

.res-icon { color: #ffcc00; width: 12px; text-align: center; }
.res-label { color: #666; width: 36px; }
.res-val { color: #33ff33; width: 30px; text-align: right; }

.res-bar {
  flex: 1;
  height: 4px;
  background: #1a1a1a;
  border-radius: 2px;
  overflow: hidden;
}

.res-fill {
  height: 100%;
  background: linear-gradient(90deg, #228822, #33ff33);
  transition: width 0.5s ease;
  border-radius: 2px;
}

.res-fill.low {
  background: linear-gradient(90deg, #aa2222, #ff4444);
  animation: lowPulse 1.5s ease-in-out infinite;
}

.res-fill.mid {
  background: linear-gradient(90deg, #aa8800, #ffcc00);
}

.res-fill.unique {
  background: linear-gradient(90deg, #6633aa, #aa66ff);
}

.res-unique .res-label { color: #aa88cc; }
.res-unique .res-icon { color: #cc99ff; }

@keyframes lowPulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

/* Citizens */
.citizen-row {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 3px 0;
  font-size: 10px;
  border-bottom: 1px solid #111;
  transition: background 0.15s;
}

.citizen-row:hover {
  background: rgba(51, 255, 51, 0.03);
}

.citizen-face { color: #ffcc00; font-size: 9px; white-space: pre; }
.citizen-name { color: #33ff33; flex: 1; }
.citizen-role { color: #888; font-size: 9px; }
.citizen-mood { font-size: 9px; }
.citizen-state { color: #557755; font-size: 9px; font-style: italic; }
.citizen-pers { color: #8866cc; font-size: 8px; font-style: italic; }
.citizen-dead { color: #ff4444; text-decoration: line-through; opacity: 0.5; }

/* Buildings */
.building-row {
  display: flex;
  justify-content: space-between;
  padding: 2px 0;
  font-size: 10px;
}

.building-name { color: #33ff33; }
.building-status { color: #888; font-size: 9px; }
.building-constructing { color: #ffcc00; }
.building-decaying { color: #cc8833; }
.building-abandoned { color: #885533; }
.building-rubble { color: #666655; }

.building-hp {
  height: 3px;
  background: #1a1a1a;
  margin-top: 2px;
  border-radius: 1px;
  overflow: hidden;
}

.building-hp-fill {
  height: 100%;
  background: #33cc33;
  transition: width 0.5s;
}

.building-hp-fill.hp-warning {
  background: #ccaa33;
}

.building-hp-fill.hp-critical {
  background: #cc3333;
}

.building-bar {
  height: 3px;
  background: #1a1a1a;
  margin-top: 2px;
  border-radius: 1px;
  overflow: hidden;
}

.building-bar-fill {
  height: 100%;
  background: #ffcc00;
  transition: width 0.5s;
}

/* Village Life / Culture */
.culture-mood {
  font-size: 12px;
  font-weight: bold;
  letter-spacing: 1px;
  margin-bottom: 4px;
}

.culture-descriptor {
  font-size: 9px;
  color: #777;
  margin-bottom: 4px;
}

.culture-activities {
  font-size: 9px;
  color: #99aa88;
  margin-bottom: 3px;
}

.culture-values {
  font-size: 9px;
  color: #aa99cc;
  margin-top: 2px;
}

.social-row {
  padding: 2px 0;
  font-size: 9px;
  border-left: 2px solid #333;
  padding-left: 6px;
  margin-bottom: 2px;
}

.social-row.info { border-color: #33ff33; color: #557755; }
.social-row.danger { border-color: #ff4444; color: #ff6644; }
.social-row.celebration { border-color: #ff66ff; color: #cc55cc; }

/* Events */
.event-row {
  padding: 2px 0;
  font-size: 10px;
  border-left: 2px solid #333;
  padding-left: 6px;
  margin-bottom: 3px;
}

.event-row.info { border-color: #33ff33; color: #33ff33; }
.event-row.warning { border-color: #ffcc00; color: #ffcc00; }
.event-row.danger { border-color: #ff4444; color: #ff4444; }
.event-row.celebration { border-color: #ff66ff; color: #ff66ff; }

/* Bottom bar */
#bottom-bar {
  height: 32px;
  background: #111;
  border-top: 1px solid #333;
  display: flex;
  align-items: center;
  padding: 0 16px;
  gap: 20px;
  font-size: 11px;
}

#home-link {
  color: #33ff33;
  text-decoration: none;
  font-size: 10px;
  font-weight: bold;
  border-right: 1px solid #333;
  padding-right: 12px;
  opacity: 0.6;
  transition: opacity 0.2s;
}
#home-link:hover { opacity: 1; }

#connection-status { font-size: 10px; }
.connected { color: #33ff33; }
.connected::before { content: '\25cf '; }
.disconnected { color: #ff4444; }
.disconnected::before { content: '\25cb '; }
.reconnecting { color: #ffcc00; }
.reconnecting::before { content: '\25cb '; }

#whisper-box {
  flex: 1;
  max-width: 280px;
  position: relative;
  display: flex;
  align-items: center;
}
#whisper-input {
  width: 100%;
  background: #0a0a0a;
  border: 1px solid #333;
  color: #88aacc;
  font-family: 'Courier New', monospace;
  font-size: 10px;
  padding: 3px 8px;
  outline: none;
  transition: border-color 0.2s;
}
#whisper-input::placeholder { color: #444; font-style: italic; }
#whisper-input:focus { border-color: #88aacc; }
#whisper-input:disabled { opacity: 0.4; }
#whisper-cooldown {
  color: #555;
  font-size: 9px;
  margin-left: 6px;
  white-space: nowrap;
}

#weather-display { color: #888; }
#tick-display { color: #444; margin-left: auto; }

/* Notifications */
#notifications {
  position: fixed;
  top: 10px;
  left: 10px;
  z-index: 20;
  display: flex;
  flex-direction: column;
  gap: 5px;
  max-width: 360px;
}

.notification {
  padding: 6px 12px;
  font-family: 'Courier New', monospace;
  font-size: 11px;
  border-left: 3px solid;
  background: rgba(17, 17, 17, 0.95);
  backdrop-filter: blur(4px);
  animation: slideIn 0.3s cubic-bezier(0.22, 1, 0.36, 1), fadeOut 0.5s ease 4.5s forwards;
}

.notification.info { border-color: #33ff33; color: #33ff33; }
.notification.warning { border-color: #ffcc00; color: #ffcc00; }
.notification.danger { border-color: #ff4444; color: #ff4444; }
.notification.celebration { border-color: #ff66ff; color: #ff66ff; }

@keyframes slideIn {
  from { opacity: 0; transform: translateX(-20px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }

/* Scene color classes (per-character coloring inside #world) */
#world .c-bld  { color: #aa8855; }
#world .c-gnd  { color: #336622; }
#world .c-gndl { color: #225511; }
#world .c-gndd { color: #1a3a11; }
#world .c-sky  { color: #aabbdd; }
#world .c-skyd { color: #778899; }
#world .c-rain { color: #5588cc; }
#world .c-star { color: #ffffcc; }
#world .c-hill { color: #446633; }
#world .c-fire { color: #ff6622; }
#world .c-fight{ color: #ff3333; }
#world .c-art  { color: #cc66ff; }
#world .c-cele { color: #ffcc00; }
#world .c-med  { color: #66aaff; }
#world .c-proj { color: #ffaa33; }
#world .c-projd{ color: #33ff99; }
#world .c-spr  { color: #88cc88; }
#world .c-lbl  { color: #ffcc00; }
#world .c-bar  { color: #ffcc00; }
#world .c-title{ color: #ffcc00; }
#world .c-walk { color: #55cc55; }
#world .c-sleep{ color: #4466aa; }
#world .c-talk { color: #88cc88; }
#world .c-name { color: #dddd66; }

/* Building-type accent colors */
#world .c-b-hut       { color: #bb9966; }
#world .c-b-farm      { color: #88bb44; }
#world .c-b-workshop  { color: #cc8833; }
#world .c-b-wall      { color: #999999; }
#world .c-b-temple    { color: #cc99ff; }
#world .c-b-watchtower{ color: #7799aa; }
#world .c-b-market    { color: #ffcc44; }
#world .c-b-library   { color: #6699cc; }
#world .c-b-storehouse{ color: #aa8844; }
#world .c-b-town_center{ color: #ddaa55; }
#world .c-b-dock      { color: #55aacc; }
/* Megastructures — vibrant, glowing endgame colors */
#world .c-b-shell_archive   { color: #ddaa44; text-shadow: 0 0 4px rgba(221, 170, 68, 0.4); }
#world .c-b-abyssal_beacon  { color: #44aaff; text-shadow: 0 0 4px rgba(68, 170, 255, 0.4); }
#world .c-b-molt_cathedral  { color: #cc88ff; text-shadow: 0 0 4px rgba(204, 136, 255, 0.4); }
#world .c-b-spawning_pools  { color: #44ddaa; text-shadow: 0 0 4px rgba(68, 221, 170, 0.4); }

/* Civilization style colors */
#world .c-gnd-v { color: #33aa44; }
#world .c-gnd-s { color: #888877; }
#world .c-gnd-m { color: #7744aa; }
#world .c-gnd-d { color: #aa8833; }
#world .c-gnd-f { color: #6699bb; }
#world .c-gnd-e { color: #aa4422; }

#world .c-civ-v { color: #88cc66; }
#world .c-civ-s { color: #99aabb; }
#world .c-civ-m { color: #aa77dd; }
#world .c-civ-d { color: #ccaa55; }
#world .c-civ-f { color: #88bbdd; }
#world .c-civ-e { color: #dd6633; }

#world .c-dec-v { color: #44cc55; }
#world .c-dec-s { color: #7799aa; }
#world .c-dec-m { color: #bb88ee; }
#world .c-dec-d { color: #ddbb66; }
#world .c-dec-f { color: #99ccee; }
#world .c-dec-e { color: #ff7744; }

/* Grass depth variants (light / deep per civ style) */
#world .c-gnd-vl { color: #44cc55; }  #world .c-gnd-vd { color: #227733; }
#world .c-gnd-sl { color: #aaaaaa; }  #world .c-gnd-sd { color: #666655; }
#world .c-gnd-ml { color: #9955cc; }  #world .c-gnd-md { color: #553388; }
#world .c-gnd-dl { color: #ccbb55; }  #world .c-gnd-dd { color: #886622; }
#world .c-gnd-fl { color: #88ccee; }  #world .c-gnd-fd { color: #447799; }
#world .c-gnd-el { color: #cc5533; }  #world .c-gnd-ed { color: #882211; }

/* Celestial bodies */
#world .c-sun     { color: #ffdd33; }
#world .c-sunglow { color: #aa8822; }
#world .c-moon    { color: #ccddff; }
#world .c-moonglow{ color: #8899bb; }

/* Water */
/* Decay states */
#world .c-decay     { color: #cc8833; }
#world .c-decay-bld { color: #aa7733; }
#world .c-abandoned { color: #885533; }
#world .c-rubble    { color: #666655; }
#world .c-overgrown { color: #448833; }

/* Dormant overgrowth system */
#world .c-ovg-sprout { color: #88cc66; }
#world .c-ovg-vine   { color: #44aa44; }
#world .c-ovg-tree   { color: #338833; }
#world .c-ovg-particle { color: #aaddaa; opacity: 0.7; }
/* Biome flower variants */
#world .c-ovg-flower-v { color: #ff88aa; } /* verdant: tropical */
#world .c-ovg-flower-s { color: #bbaa88; } /* stone: rock flowers */
#world .c-ovg-flower-m { color: #bb88ff; } /* mystic: crystal */
#world .c-ovg-flower-d { color: #ff8844; } /* desert: cactus bloom */
#world .c-ovg-flower-f { color: #aaccee; } /* frost: ice flowers */
#world .c-ovg-flower-e { color: #ff6633; } /* ember: fire bloom */
/* Nomad camp */
#world .c-nomad      { color: #aa8855; }
#world .c-nomad-fire { color: #ff6622; }
#world .c-nomad-glow { color: #ff9944; opacity: 0.6; }
#world .c-nomad-bug  { color: #ccff66; opacity: 0.8; }
/* Overgrowth sidebar */
.ovg-bar { color: #44aa44; font-size: 10px; }
.ovg-stage { color: #88cc66; font-size: 9px; }
.ovg-bonus { color: #557755; font-size: 9px; }
/* Time-of-day variants for overgrowth */
body.night #world .c-ovg-sprout  { color: #2a5522; }
body.night #world .c-ovg-vine    { color: #1a3a1a; }
body.night #world .c-ovg-tree    { color: #1a2a18; }
body.night #world .c-ovg-particle { color: #446644; }
body.night #world .c-nomad-fire  { color: #ff4411; text-shadow: 0 0 6px rgba(255, 100, 34, 0.6); }
body.night #world .c-nomad-glow  { color: #ff7733; opacity: 0.5; text-shadow: 0 0 8px rgba(255, 119, 51, 0.4); }
body.night #world .c-nomad-bug   { color: #aaff44; opacity: 0.9; text-shadow: 0 0 4px rgba(170, 255, 68, 0.5); }
body.dawn #world .c-ovg-sprout   { color: #6a9944; }
body.dusk #world .c-ovg-sprout   { color: #5a7733; }
body.dusk #world .c-nomad-fire   { color: #ff5522; text-shadow: 0 0 4px rgba(255, 85, 34, 0.4); }

#world .c-water  { color: #3388cc; }
#world .c-waterl { color: #55aadd; }
#world .c-fish   { color: #66ccaa; }

/* Ghost echoes */
#world .c-ghost { color: #334455; opacity: 0.6; }

/* Death → shell animation */
#world .c-dying { color: #886644; opacity: 0.8; }
#world .c-shell { color: #997744; opacity: 0.5; }

/* Molting shimmer */
#world .c-molt     { color: #ffcc33; }
#world .c-molt-alt { color: #ffdd88; }

/* Shell relics */
#world .c-relic { color: #cc9944; }

/* Monolith / Spire of Shells */
#world .c-monolith       { color: #ccbb88; }
#world .c-monolith-decay { color: #887755; }

/* Ice / Tundra terrain */
#world .c-terrain-ice    { color: #ccddee; }
#world .c-terrain-tundra { color: #8899aa; }

/* Seasonal visual effects */
#world .c-season-spring1     { color: #ff88aa; }
#world .c-season-spring2     { color: #ffaacc; }
#world .c-season-spring3     { color: #ffcc88; }
#world .c-season-summer      { color: #ff8833; opacity: 0.5; }
#world .c-season-summer-faint{ color: #ff6622; opacity: 0.25; }
#world .c-season-autumn      { color: #cc8833; }
#world .c-season-autumn-dark { color: #995522; }
#world .c-season-winter      { color: #ddeeff; }

/* Crops */
#world .c-crop  { color: #66aa44; }
#world .c-croph { color: #ddaa33; }

/* Resource gathering activities */
#world .c-chop { color: #aa8844; }
#world .c-mine { color: #8899aa; }
#world .c-fish { color: #4488cc; }
#world .c-hunt { color: #88aa44; }

/* Resource nodes */
#world .c-tree { color: #668844; }
#world .c-rock { color: #889999; }
#world .c-fish-spot { color: #4488aa; }
#world .c-depleted { color: #555555; opacity: 0.5; }

/* ─── Hill depth layers ─── */
#world .c-hill-far  { color: #334422; }
#world .c-hill-mid  { color: #446633; }
#world .c-hill-near { color: #558844; }

/* Hill colors respond to time of day */
body.dawn #world .c-hill-far  { color: #4a3a22; }
body.dawn #world .c-hill-mid  { color: #5c4a2a; }
body.dawn #world .c-hill-near { color: #6e5c33; }

body.noon #world .c-hill-far  { color: #445533; }
body.noon #world .c-hill-mid  { color: #557744; }
body.noon #world .c-hill-near { color: #669955; }

body.afternoon #world .c-hill-far  { color: #3e4c28; }
body.afternoon #world .c-hill-mid  { color: #4e5e35; }
body.afternoon #world .c-hill-near { color: #5e6e45; }

body.dusk #world .c-hill-far  { color: #3d2a1a; }
body.dusk #world .c-hill-mid  { color: #4e3822; }
body.dusk #world .c-hill-near { color: #5f462a; }

body.night #world .c-hill-far  { color: #1a2218; }
body.night #world .c-hill-mid  { color: #223320; }
body.night #world .c-hill-near { color: #2a3a28; }

/* ─── WEATHER / SEASON / BIOME TINTING ─── */
/* Each weather tints the civ's ground toward a mood color while preserving identity */
/* Snow: blend toward white-blue. Verdant→mint, Mystic→lavender, Ember→rose, etc. */
body.weather-snow #world .c-gnd-v, body.season-winter #world .c-gnd-v, body.biome-ice #world .c-gnd-v, body.biome-tundra #world .c-gnd-v { color: #88ccaa; }
body.weather-snow #world .c-gnd-vl, body.season-winter #world .c-gnd-vl, body.biome-ice #world .c-gnd-vl, body.biome-tundra #world .c-gnd-vl { color: #aaddbb; }
body.weather-snow #world .c-gnd-vm, body.season-winter #world .c-gnd-vm, body.biome-ice #world .c-gnd-vm, body.biome-tundra #world .c-gnd-vm { color: #99ccaa; }
body.weather-snow #world .c-gnd-vd, body.season-winter #world .c-gnd-vd, body.biome-ice #world .c-gnd-vd, body.biome-tundra #world .c-gnd-vd { color: #77bb99; }
body.weather-snow #world .c-gnd-s, body.season-winter #world .c-gnd-s, body.biome-ice #world .c-gnd-s, body.biome-tundra #world .c-gnd-s { color: #aabbbb; }
body.weather-snow #world .c-gnd-sl, body.season-winter #world .c-gnd-sl, body.biome-ice #world .c-gnd-sl, body.biome-tundra #world .c-gnd-sl { color: #bbcccc; }
body.weather-snow #world .c-gnd-sm, body.season-winter #world .c-gnd-sm, body.biome-ice #world .c-gnd-sm, body.biome-tundra #world .c-gnd-sm { color: #aabbbb; }
body.weather-snow #world .c-gnd-sd, body.season-winter #world .c-gnd-sd, body.biome-ice #world .c-gnd-sd, body.biome-tundra #world .c-gnd-sd { color: #99aaaa; }
body.weather-snow #world .c-gnd-m, body.season-winter #world .c-gnd-m, body.biome-ice #world .c-gnd-m, body.biome-tundra #world .c-gnd-m { color: #aa99cc; }
body.weather-snow #world .c-gnd-ml, body.season-winter #world .c-gnd-ml, body.biome-ice #world .c-gnd-ml, body.biome-tundra #world .c-gnd-ml { color: #bbaadd; }
body.weather-snow #world .c-gnd-mm, body.season-winter #world .c-gnd-mm, body.biome-ice #world .c-gnd-mm, body.biome-tundra #world .c-gnd-mm { color: #aa99cc; }
body.weather-snow #world .c-gnd-md, body.season-winter #world .c-gnd-md, body.biome-ice #world .c-gnd-md, body.biome-tundra #world .c-gnd-md { color: #9988bb; }
body.weather-snow #world .c-gnd-d, body.season-winter #world .c-gnd-d, body.biome-ice #world .c-gnd-d, body.biome-tundra #world .c-gnd-d { color: #bbaa88; }
body.weather-snow #world .c-gnd-dl, body.season-winter #world .c-gnd-dl, body.biome-ice #world .c-gnd-dl, body.biome-tundra #world .c-gnd-dl { color: #ccbb99; }
body.weather-snow #world .c-gnd-dm, body.season-winter #world .c-gnd-dm, body.biome-ice #world .c-gnd-dm, body.biome-tundra #world .c-gnd-dm { color: #bbaa88; }
body.weather-snow #world .c-gnd-dd, body.season-winter #world .c-gnd-dd, body.biome-ice #world .c-gnd-dd, body.biome-tundra #world .c-gnd-dd { color: #aa9977; }
body.weather-snow #world .c-gnd-f, body.season-winter #world .c-gnd-f, body.biome-ice #world .c-gnd-f, body.biome-tundra #world .c-gnd-f { color: #99bbcc; }
body.weather-snow #world .c-gnd-fl, body.season-winter #world .c-gnd-fl, body.biome-ice #world .c-gnd-fl, body.biome-tundra #world .c-gnd-fl { color: #aaccdd; }
body.weather-snow #world .c-gnd-fm, body.season-winter #world .c-gnd-fm, body.biome-ice #world .c-gnd-fm, body.biome-tundra #world .c-gnd-fm { color: #99bbcc; }
body.weather-snow #world .c-gnd-fd, body.season-winter #world .c-gnd-fd, body.biome-ice #world .c-gnd-fd, body.biome-tundra #world .c-gnd-fd { color: #88aabb; }
body.weather-snow #world .c-gnd-e, body.season-winter #world .c-gnd-e, body.biome-ice #world .c-gnd-e, body.biome-tundra #world .c-gnd-e { color: #bb9988; }
body.weather-snow #world .c-gnd-el, body.season-winter #world .c-gnd-el, body.biome-ice #world .c-gnd-el, body.biome-tundra #world .c-gnd-el { color: #ccaa99; }
body.weather-snow #world .c-gnd-em, body.season-winter #world .c-gnd-em, body.biome-ice #world .c-gnd-em, body.biome-tundra #world .c-gnd-em { color: #bb9988; }
body.weather-snow #world .c-gnd-ed, body.season-winter #world .c-gnd-ed, body.biome-ice #world .c-gnd-ed, body.biome-tundra #world .c-gnd-ed { color: #aa8877; }
/* Snow hills */
body.weather-snow #world .c-hill-far, body.season-winter #world .c-hill-far, body.biome-ice #world .c-hill-far, body.biome-tundra #world .c-hill-far { color: #889999; }
body.weather-snow #world .c-hill-mid, body.season-winter #world .c-hill-mid, body.biome-ice #world .c-hill-mid, body.biome-tundra #world .c-hill-mid { color: #aabbbb; }
body.weather-snow #world .c-hill-near, body.season-winter #world .c-hill-near, body.biome-ice #world .c-hill-near, body.biome-tundra #world .c-hill-near { color: #ccdddd; }
/* Snow vegetation + decor */
body.weather-snow #world .c-dec-v, body.season-winter #world .c-dec-v, body.biome-ice #world .c-dec-v, body.biome-tundra #world .c-dec-v { color: #99ccaa; }
body.weather-snow #world .c-dec-s, body.season-winter #world .c-dec-s, body.biome-ice #world .c-dec-s, body.biome-tundra #world .c-dec-s { color: #aabbbb; }
body.weather-snow #world .c-dec-m, body.season-winter #world .c-dec-m, body.biome-ice #world .c-dec-m, body.biome-tundra #world .c-dec-m { color: #bbaadd; }
body.weather-snow #world .c-dec-d, body.season-winter #world .c-dec-d, body.biome-ice #world .c-dec-d, body.biome-tundra #world .c-dec-d { color: #ccbb99; }
body.weather-snow #world .c-dec-f, body.season-winter #world .c-dec-f, body.biome-ice #world .c-dec-f, body.biome-tundra #world .c-dec-f { color: #aaccdd; }
body.weather-snow #world .c-dec-e, body.season-winter #world .c-dec-e, body.biome-ice #world .c-dec-e, body.biome-tundra #world .c-dec-e { color: #ccaa99; }

/* Rain: darken + desaturate — wet ground */
body.weather-rain #world .c-gnd-v { color: #226633; } body.weather-rain #world .c-gnd-vl { color: #338844; } body.weather-rain #world .c-gnd-vm { color: #2a7738; } body.weather-rain #world .c-gnd-vd { color: #1a5522; }
body.weather-rain #world .c-gnd-s { color: #666655; } body.weather-rain #world .c-gnd-sl { color: #888877; } body.weather-rain #world .c-gnd-sm { color: #777766; } body.weather-rain #world .c-gnd-sd { color: #555544; }
body.weather-rain #world .c-gnd-m { color: #553388; } body.weather-rain #world .c-gnd-ml { color: #7744aa; } body.weather-rain #world .c-gnd-mm { color: #663899; } body.weather-rain #world .c-gnd-md { color: #442266; }
body.weather-rain #world .c-gnd-d { color: #886622; } body.weather-rain #world .c-gnd-dl { color: #aa8833; } body.weather-rain #world .c-gnd-dm { color: #997733; } body.weather-rain #world .c-gnd-dd { color: #664411; }
body.weather-rain #world .c-gnd-f { color: #447799; } body.weather-rain #world .c-gnd-fl { color: #6699bb; } body.weather-rain #world .c-gnd-fm { color: #5588aa; } body.weather-rain #world .c-gnd-fd { color: #336688; }
body.weather-rain #world .c-gnd-e { color: #882211; } body.weather-rain #world .c-gnd-el { color: #aa3322; } body.weather-rain #world .c-gnd-em { color: #992a1a; } body.weather-rain #world .c-gnd-ed { color: #661100; }
body.weather-rain #world .c-hill-far { color: #223311; } body.weather-rain #world .c-hill-mid { color: #335522; } body.weather-rain #world .c-hill-near { color: #446633; }

/* Storm: very dark — dramatic contrast for lightning */
body.weather-storm #world .c-gnd-v { color: #1a4422; } body.weather-storm #world .c-gnd-vl { color: #225533; } body.weather-storm #world .c-gnd-vm { color: #1e4d28; } body.weather-storm #world .c-gnd-vd { color: #113318; }
body.weather-storm #world .c-gnd-s { color: #444433; } body.weather-storm #world .c-gnd-sl { color: #555544; } body.weather-storm #world .c-gnd-sm { color: #4d4d3e; } body.weather-storm #world .c-gnd-sd { color: #333322; }
body.weather-storm #world .c-gnd-m { color: #331e55; } body.weather-storm #world .c-gnd-ml { color: #442266; } body.weather-storm #world .c-gnd-mm { color: #3a2060; } body.weather-storm #world .c-gnd-md { color: #221144; }
body.weather-storm #world .c-gnd-d { color: #554411; } body.weather-storm #world .c-gnd-dl { color: #665522; } body.weather-storm #world .c-gnd-dm { color: #5e4d18; } body.weather-storm #world .c-gnd-dd { color: #443300; }
body.weather-storm #world .c-gnd-f { color: #335566; } body.weather-storm #world .c-gnd-fl { color: #447788; } body.weather-storm #world .c-gnd-fm { color: #3a6677; } body.weather-storm #world .c-gnd-fd { color: #224455; }
body.weather-storm #world .c-gnd-e { color: #551100; } body.weather-storm #world .c-gnd-el { color: #662200; } body.weather-storm #world .c-gnd-em { color: #5e1800; } body.weather-storm #world .c-gnd-ed { color: #440000; }
body.weather-storm #world .c-hill-far { color: #111a0d; } body.weather-storm #world .c-hill-mid { color: #1a2a15; } body.weather-storm #world .c-hill-near { color: #22331e; }

/* Fog: desaturate heavily — everything washed out */
body.weather-fog #world .c-gnd-v { color: #669977; } body.weather-fog #world .c-gnd-vl { color: #77aa88; } body.weather-fog #world .c-gnd-vm { color: #6ea27e; } body.weather-fog #world .c-gnd-vd { color: #558866; }
body.weather-fog #world .c-gnd-s { color: #888888; } body.weather-fog #world .c-gnd-sl { color: #999999; } body.weather-fog #world .c-gnd-sm { color: #909090; } body.weather-fog #world .c-gnd-sd { color: #777777; }
body.weather-fog #world .c-gnd-m { color: #887799; } body.weather-fog #world .c-gnd-ml { color: #9988aa; } body.weather-fog #world .c-gnd-mm { color: #8e7ea2; } body.weather-fog #world .c-gnd-md { color: #776688; }
body.weather-fog #world .c-gnd-d { color: #998866; } body.weather-fog #world .c-gnd-dl { color: #aa9977; } body.weather-fog #world .c-gnd-dm { color: #a2906e; } body.weather-fog #world .c-gnd-dd { color: #887755; }
body.weather-fog #world .c-gnd-f { color: #889999; } body.weather-fog #world .c-gnd-fl { color: #99aaaa; } body.weather-fog #world .c-gnd-fm { color: #90a2a2; } body.weather-fog #world .c-gnd-fd { color: #778888; }
body.weather-fog #world .c-gnd-e { color: #996655; } body.weather-fog #world .c-gnd-el { color: #aa7766; } body.weather-fog #world .c-gnd-em { color: #a2605e; } body.weather-fog #world .c-gnd-ed { color: #885544; }
body.weather-fog #world .c-hill-far { color: #556655; } body.weather-fog #world .c-hill-mid { color: #667766; } body.weather-fog #world .c-hill-near { color: #778877; }

/* Heat: warm yellowish tint */
body.weather-heat #world .c-gnd-v { color: #66aa33; } body.weather-heat #world .c-gnd-vl { color: #88cc44; } body.weather-heat #world .c-gnd-vm { color: #77bb3a; } body.weather-heat #world .c-gnd-vd { color: #559922; }
body.weather-heat #world .c-gnd-s { color: #999977; } body.weather-heat #world .c-gnd-sl { color: #bbbb99; } body.weather-heat #world .c-gnd-sm { color: #aaaa88; } body.weather-heat #world .c-gnd-sd { color: #777755; }
body.weather-heat #world .c-gnd-m { color: #8855aa; } body.weather-heat #world .c-gnd-ml { color: #9966bb; } body.weather-heat #world .c-gnd-mm { color: #905dbb; } body.weather-heat #world .c-gnd-md { color: #664499; }
body.weather-heat #world .c-gnd-d { color: #cc9933; } body.weather-heat #world .c-gnd-dl { color: #ddbb44; } body.weather-heat #world .c-gnd-dm { color: #d4aa3a; } body.weather-heat #world .c-gnd-dd { color: #aa7722; }
body.weather-heat #world .c-gnd-f { color: #88aaaa; } body.weather-heat #world .c-gnd-fl { color: #99ccbb; } body.weather-heat #world .c-gnd-fm { color: #90bbbb; } body.weather-heat #world .c-gnd-fd { color: #669999; }
body.weather-heat #world .c-gnd-e { color: #cc5522; } body.weather-heat #world .c-gnd-el { color: #dd6633; } body.weather-heat #world .c-gnd-em { color: #d45e2a; } body.weather-heat #world .c-gnd-ed { color: #aa3311; }
body.weather-heat #world .c-hill-far { color: #445522; } body.weather-heat #world .c-hill-mid { color: #557733; } body.weather-heat #world .c-hill-near { color: #669944; }

/* Spring season: vivid, saturated greens */
body.season-spring #world .c-gnd-v { color: #44cc55; } body.season-spring #world .c-gnd-vl { color: #55ee66; } body.season-spring #world .c-gnd-vm { color: #4dd55e; } body.season-spring #world .c-gnd-vd { color: #33aa44; }
body.season-spring #world .c-gnd-s { color: #99aa88; } body.season-spring #world .c-gnd-sl { color: #aabb99; } body.season-spring #world .c-gnd-sm { color: #a2b290; } body.season-spring #world .c-gnd-sd { color: #889977; }
body.season-spring #world .c-gnd-m { color: #8855cc; } body.season-spring #world .c-gnd-ml { color: #aa66ee; } body.season-spring #world .c-gnd-mm { color: #995ddd; } body.season-spring #world .c-gnd-md { color: #6644aa; }
body.season-spring #world .c-gnd-d { color: #bbaa44; } body.season-spring #world .c-gnd-dl { color: #ddcc55; } body.season-spring #world .c-gnd-dm { color: #ccbb4d; } body.season-spring #world .c-gnd-dd { color: #aa9933; }
body.season-spring #world .c-gnd-f { color: #77bbcc; } body.season-spring #world .c-gnd-fl { color: #88ddee; } body.season-spring #world .c-gnd-fm { color: #80ccdd; } body.season-spring #world .c-gnd-fd { color: #66aabb; }
body.season-spring #world .c-gnd-e { color: #cc5533; } body.season-spring #world .c-gnd-el { color: #ee6644; } body.season-spring #world .c-gnd-em { color: #dd5e3a; } body.season-spring #world .c-gnd-ed { color: #aa4422; }
body.season-spring #world .c-hill-far { color: #335522; } body.season-spring #world .c-hill-mid { color: #448833; } body.season-spring #world .c-hill-near { color: #55aa44; }

/* Autumn season: warm amber/orange shift */
body.season-autumn #world .c-gnd-v { color: #889933; } body.season-autumn #world .c-gnd-vl { color: #aaaa44; } body.season-autumn #world .c-gnd-vm { color: #99a23a; } body.season-autumn #world .c-gnd-vd { color: #667722; }
body.season-autumn #world .c-gnd-s { color: #998866; } body.season-autumn #world .c-gnd-sl { color: #aa9977; } body.season-autumn #world .c-gnd-sm { color: #a2906e; } body.season-autumn #world .c-gnd-sd { color: #887755; }
body.season-autumn #world .c-gnd-m { color: #885588; } body.season-autumn #world .c-gnd-ml { color: #996699; } body.season-autumn #world .c-gnd-mm { color: #905e90; } body.season-autumn #world .c-gnd-md { color: #774477; }
body.season-autumn #world .c-gnd-d { color: #bb8822; } body.season-autumn #world .c-gnd-dl { color: #cc9933; } body.season-autumn #world .c-gnd-dm { color: #c4902a; } body.season-autumn #world .c-gnd-dd { color: #996611; }
body.season-autumn #world .c-gnd-f { color: #778899; } body.season-autumn #world .c-gnd-fl { color: #8899aa; } body.season-autumn #world .c-gnd-fm { color: #8090a2; } body.season-autumn #world .c-gnd-fd { color: #667788; }
body.season-autumn #world .c-gnd-e { color: #bb5522; } body.season-autumn #world .c-gnd-el { color: #dd6633; } body.season-autumn #world .c-gnd-em { color: #cc5e2a; } body.season-autumn #world .c-gnd-ed { color: #993311; }
body.season-autumn #world .c-hill-far { color: #443311; } body.season-autumn #world .c-hill-mid { color: #554422; } body.season-autumn #world .c-hill-near { color: #776633; }

/* ─── Bonsai tree colors ─── */
#world .c-tree   { color: #338833; }
#world .c-tree-t { color: #664422; }
body.dawn #world .c-tree   { color: #5a6a30; }
body.dawn #world .c-tree-t { color: #7a5533; }
body.noon #world .c-tree   { color: #44aa44; }
body.noon #world .c-tree-t { color: #886633; }
body.afternoon #world .c-tree   { color: #3a7a3a; }
body.afternoon #world .c-tree-t { color: #775530; }
body.dusk #world .c-tree   { color: #4a5a28; }
body.dusk #world .c-tree-t { color: #6a4422; }
body.night #world .c-tree   { color: #1a3318; }
body.night #world .c-tree-t { color: #332211; }

/* ─── Canopy trees (biome-tinted) ─── */
#world .c-canopy-forest   { color: #22aa44; }
#world .c-canopy-plains   { color: #88aa44; }
#world .c-canopy-swamp    { color: #558844; }
#world .c-canopy-mountain { color: #668866; }
#world .c-canopy-desert   { color: #aaaa44; }
#world .c-canopy-ice      { color: #88ccee; }
#world .c-canopy-tundra   { color: #99aabb; }
body.dawn #world .c-canopy-forest   { color: #3a7a30; }
body.dawn #world .c-canopy-plains   { color: #6a8a30; }
body.dawn #world .c-canopy-swamp    { color: #4a6a30; }
body.dawn #world .c-canopy-mountain { color: #5a7a5a; }
body.dawn #world .c-canopy-desert   { color: #8a8a30; }
body.dawn #world .c-canopy-ice      { color: #6a9aaa; }
body.dawn #world .c-canopy-tundra   { color: #7a8a99; }
body.noon #world .c-canopy-forest   { color: #33cc55; }
body.noon #world .c-canopy-plains   { color: #99cc55; }
body.noon #world .c-canopy-swamp    { color: #66aa55; }
body.noon #world .c-canopy-mountain { color: #77aa77; }
body.noon #world .c-canopy-desert   { color: #cccc55; }
body.noon #world .c-canopy-ice      { color: #aaddff; }
body.noon #world .c-canopy-tundra   { color: #aabbcc; }
body.dusk #world .c-canopy-forest   { color: #2a5a22; }
body.dusk #world .c-canopy-plains   { color: #5a6a22; }
body.dusk #world .c-canopy-swamp    { color: #3a4a22; }
body.dusk #world .c-canopy-mountain { color: #4a5a4a; }
body.dusk #world .c-canopy-desert   { color: #6a6a22; }
body.dusk #world .c-canopy-ice      { color: #5a7a88; }
body.dusk #world .c-canopy-tundra   { color: #5a6a77; }
body.night #world .c-canopy-forest   { color: #112a11; }
body.night #world .c-canopy-plains   { color: #2a3311; }
body.night #world .c-canopy-swamp    { color: #1a2a11; }
body.night #world .c-canopy-mountain { color: #223322; }
body.night #world .c-canopy-desert   { color: #333311; }
body.night #world .c-canopy-ice      { color: #2a3a44; }
body.night #world .c-canopy-tundra   { color: #2a3344; }

/* ─── Ground mid-accent per civ style ─── */
#world .c-gnd-vm { color: #39bb4d; }
#world .c-gnd-sm { color: #999988; }
#world .c-gnd-mm { color: #884dbb; }
#world .c-gnd-dm { color: #bb9944; }
#world .c-gnd-fm { color: #77bbcc; }
#world .c-gnd-em { color: #bb3a2a; }

/* ─── Vegetation accents ─── */
#world .c-veg-rock { color: #667766; }
#world .c-veg-root { color: #554433; }

/* ─── Building tier colors (type-t2 / type-t3 = brighter) ─── */
#world .c-b-hut-t2        { color: #ccbb88; }
#world .c-b-hut-t3        { color: #eedd99; }
#world .c-b-farm-t2       { color: #aadd66; }
#world .c-b-farm-t3       { color: #ccff88; }
#world .c-b-workshop-t2   { color: #ddaa55; }
#world .c-b-workshop-t3   { color: #ffcc77; }
#world .c-b-wall-t2       { color: #bbbbbb; }
#world .c-b-wall-t3       { color: #dddddd; }
#world .c-b-temple-t2     { color: #ddbbff; }
#world .c-b-temple-t3     { color: #eeddff; }
#world .c-b-watchtower-t2 { color: #99bbcc; }
#world .c-b-watchtower-t3 { color: #bbddee; }
#world .c-b-market-t2     { color: #ffdd66; }
#world .c-b-market-t3     { color: #ffee88; }
#world .c-b-library-t2    { color: #88bbee; }
#world .c-b-library-t3    { color: #aaddff; }
#world .c-b-storehouse-t2 { color: #ccaa66; }
#world .c-b-storehouse-t3 { color: #eebb77; }
#world .c-b-town_center-t2{ color: #eebb66; }
#world .c-b-town_center-t3{ color: #ffdd88; }
#world .c-b-dock-t2       { color: #77ccee; }
#world .c-b-dock-t3       { color: #99eeff; }
#world .c-b-shell_archive-t2   { color: #eebb55; text-shadow: 0 0 5px rgba(238, 187, 85, 0.5); }
#world .c-b-shell_archive-t3   { color: #ffcc66; text-shadow: 0 0 6px rgba(255, 204, 102, 0.6); }
#world .c-b-abyssal_beacon-t2  { color: #66ccff; text-shadow: 0 0 5px rgba(102, 204, 255, 0.5); }
#world .c-b-abyssal_beacon-t3  { color: #88eeff; text-shadow: 0 0 6px rgba(136, 238, 255, 0.6); }
#world .c-b-molt_cathedral-t2  { color: #ddaaff; text-shadow: 0 0 5px rgba(221, 170, 255, 0.5); }
#world .c-b-molt_cathedral-t3  { color: #eeccff; text-shadow: 0 0 6px rgba(238, 204, 255, 0.6); }
#world .c-b-spawning_pools-t2  { color: #66eebb; text-shadow: 0 0 5px rgba(102, 238, 187, 0.5); }
#world .c-b-spawning_pools-t3  { color: #88ffcc; text-shadow: 0 0 6px rgba(136, 255, 204, 0.6); }

/* ─── Villager name colors by role ─── */
#world .c-n-idle       { color: #888888; }
#world .c-n-idle-hi    { color: #bbbbbb; }
#world .c-n-farmer     { color: #66cc44; }
#world .c-n-farmer-hi  { color: #88ff66; }
#world .c-n-warrior    { color: #ff5544; }
#world .c-n-warrior-hi { color: #ff7766; }
#world .c-n-builder    { color: #ee9933; }
#world .c-n-builder-hi { color: #ffbb55; }
#world .c-n-scout      { color: #44cccc; }
#world .c-n-scout-hi   { color: #66eeee; }
#world .c-n-scholar    { color: #5599ee; }
#world .c-n-scholar-hi { color: #77bbff; }
#world .c-n-priest     { color: #bb77ee; }
#world .c-n-priest-hi  { color: #dd99ff; }
#world .c-n-fisherman     { color: #44bbaa; }
#world .c-n-fisherman-hi  { color: #66ddcc; }
#world .c-n-hunter        { color: #aa8844; }
#world .c-n-hunter-hi     { color: #ccaa66; }

/* ─── Weather color classes ─── */
#world .c-w-rain      { color: #5588cc; }
#world .c-w-storm     { color: #7799dd; }
#world .c-w-snow      { color: #ccddee; }
#world .c-w-fog       { color: #889999; }
#world .c-w-heat      { color: #ff6622; }
#world .c-w-fog-dense { color: #667777; }
#world .c-w-fog-wisp  { color: #99aabb; }
#world .c-w-lightning  { color: #ffffaa; }

/* Time of day */
body.dawn #world { color: #ffaa66; text-shadow: 0 0 4px rgba(255, 170, 102, 0.15); filter: sepia(0.12) saturate(1.15); }
body.morning #world { color: #33ff33; }
body.noon #world { color: #eeffee; text-shadow: 0 0 4px rgba(255, 255, 255, 0.1); filter: brightness(1.06) saturate(1.05); }
body.afternoon #world { color: #ccff99; filter: sepia(0.06); }
body.dusk #world { color: #ff8844; text-shadow: 0 0 4px rgba(255, 102, 51, 0.15); filter: sepia(0.2) saturate(1.3) brightness(0.88); }
body.night #world { color: #6677cc; text-shadow: 0 0 6px rgba(102, 102, 204, 0.2); filter: saturate(0.45) brightness(0.65) hue-rotate(15deg); }
body.night { background: #050510; }
body.night #sidebar { background: #060612; }
body.dusk { background: #0f0808; }
body.dusk #sidebar { background: #0f0a08; }
body.dawn { background: #0f0a05; }
body.dawn #sidebar { background: #0f0a07; }

#error-overlay {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.95);
  z-index: 100;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  color: #ff4444;
  font-size: 14px;
  text-align: center;
}

#error-overlay.visible { display: flex; }

/* Easter egg: CRT mode (?crt=1) */
body.crt-mode #scene-container {
  overflow: hidden;
  border-radius: 12px;
}

body.crt-mode #scene-container::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background: repeating-linear-gradient(
    0deg,
    rgba(0, 0, 0, 0.15) 0px,
    rgba(0, 0, 0, 0.15) 1px,
    transparent 1px,
    transparent 3px
  );
  pointer-events: none;
  z-index: 10;
}

body.crt-mode #scene-container::after {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background: radial-gradient(ellipse at center, transparent 60%, rgba(0, 0, 0, 0.4) 100%);
  pointer-events: none;
  z-index: 11;
}

body.crt-mode #world {
  animation: crtFlicker 0.05s infinite alternate;
}

@keyframes crtFlicker {
  from { opacity: 0.97; }
  to { opacity: 1; }
}

/* ─── Planetary Event Banner ─── */
.planetary-banner {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 15;
  padding: 4px 16px;
  font-family: 'Courier New', Courier, monospace;
  font-size: 11px;
  text-align: center;
  letter-spacing: 1px;
  animation: peBanner 2s ease-in-out infinite;
  pointer-events: none;
}

.planetary-banner.hidden { display: none; }

.planetary-banner .pe-icon { font-size: 14px; margin-right: 6px; }
.planetary-banner .pe-desc { font-size: 9px; opacity: 0.7; margin-left: 8px; }

@keyframes peBanner {
  0%, 100% { opacity: 0.85; }
  50% { opacity: 1; }
}

.pe-eclipse  { background: linear-gradient(90deg, rgba(20,10,40,0.9), rgba(50,20,80,0.9)); color: #bb88ff; border-bottom: 1px solid #6633aa; }
.pe-meteor   { background: linear-gradient(90deg, rgba(40,20,10,0.9), rgba(80,40,10,0.9)); color: #ffaa44; border-bottom: 1px solid #cc6622; }
.pe-tidal    { background: linear-gradient(90deg, rgba(10,20,40,0.9), rgba(10,40,80,0.9)); color: #55bbff; border-bottom: 1px solid #2277bb; }
.pe-shell    { background: linear-gradient(90deg, rgba(20,30,20,0.9), rgba(30,60,30,0.9)); color: #88ff88; border-bottom: 1px solid #33aa33; }
.pe-blood    { background: linear-gradient(90deg, rgba(40,10,10,0.9), rgba(80,10,10,0.9)); color: #ff4444; border-bottom: 1px solid #aa2222; }
.pe-golden   { background: linear-gradient(90deg, rgba(40,30,10,0.9), rgba(80,60,10,0.9)); color: #ffdd44; border-bottom: 1px solid #ccaa22; }
.pe-molt     { background: linear-gradient(90deg, rgba(40,30,10,0.9), rgba(60,50,20,0.9)); color: #ffcc44; border-bottom: 1px solid #aa8822; }

/* ─── Biome panel ─── */
.biome-row {
  display: flex;
  align-items: center;
  gap: 4px;
  margin-bottom: 3px;
  font-size: 9px;
}

.biome-row .biome-label { color: #888; width: 56px; text-transform: capitalize; }
.biome-row .biome-pct { color: #557755; width: 28px; text-align: right; }

.biome-bar {
  flex: 1;
  height: 4px;
  background: #1a1a1a;
  border-radius: 2px;
  overflow: hidden;
}

.biome-fill {
  height: 100%;
  border-radius: 2px;
  transition: width 0.5s ease;
}

.biome-fill.plains  { background: #33aa44; }
.biome-fill.forest  { background: #227733; }
.biome-fill.mountain{ background: #888877; }
.biome-fill.water   { background: #3388cc; }
.biome-fill.desert  { background: #aa8833; }
.biome-fill.swamp   { background: #557744; }
.biome-fill.ice     { background: #ccddee; }
.biome-fill.tundra  { background: #8899aa; }

.biome-explored {
  font-size: 9px;
  color: #555;
  margin-top: 4px;
}

/* ─── Book of Discoveries overlay ─── */
.book-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.92);
  z-index: 50;
  display: flex;
  align-items: center;
  justify-content: center;
}

.book-overlay.hidden { display: none; }

.book-content {
  width: 600px;
  max-width: 90vw;
  max-height: 80vh;
  background: #0a0a0a;
  border: 1px solid #333;
  font-family: 'Courier New', Courier, monospace;
  display: flex;
  flex-direction: column;
}

.book-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  border-bottom: 1px solid #333;
  color: #ffcc00;
  font-size: 12px;
  letter-spacing: 2px;
}

.book-close {
  cursor: pointer;
  color: #666;
  transition: color 0.2s;
}

.book-close:hover { color: #ff4444; }

.book-entries {
  overflow-y: auto;
  padding: 12px;
  font-size: 11px;
  line-height: 1.5;
  color: #88cc88;
  flex: 1;
  scrollbar-width: thin;
  scrollbar-color: #333 #0a0a0a;
}

.book-entry {
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid #1a1a1a;
}

.book-entry-title {
  color: #ffcc00;
  font-size: 11px;
  margin-bottom: 4px;
}

.book-entry-meta {
  color: #555;
  font-size: 9px;
  margin-bottom: 4px;
}

.book-entry-body {
  color: #88cc88;
}

.bottom-btn {
  color: #33ff33;
  cursor: pointer;
  font-size: 11px;
  font-weight: bold;
  opacity: 0.6;
  transition: opacity 0.2s;
  border: 1px solid #333;
  padding: 1px 6px;
  border-radius: 2px;
}

.bottom-btn:hover { opacity: 1; }

/* ===== MOBILE RESPONSIVE ===== */
@media (max-width: 768px) {
  body { overflow: auto; height: auto; }

  #app {
    flex-direction: column;
    height: auto;
    min-height: 100vh;
  }

  #scene-container {
    width: 100%;
    overflow: hidden;
    -webkit-overflow-scrolling: touch;
    min-height: 35vh;
    max-height: 55vh;
    align-items: center;
    justify-content: center;
  }

  #world {
    font-size: 7px;
    line-height: 1.05;
    padding: 2px 4px;
    transform-origin: center center;
    max-width: 100vw;
    overflow: hidden;
  }

  #sidebar {
    width: 100%;
    border-left: none;
    border-top: 1px solid #222;
    overflow-y: visible;
    max-height: none;
  }

  #bottom-bar {
    position: sticky;
    bottom: 0;
    z-index: 15;
    font-size: 10px;
    padding: 0 8px;
    gap: 10px;
  }

  #notifications {
    max-width: calc(100vw - 20px);
    font-size: 10px;
  }

  .panel { padding: 6px 8px; }
  .panel-title { font-size: 9px; letter-spacing: 2px; }
  .info-header { font-size: 12px; }
  .citizen-row { gap: 4px; }

  /* Book overlay mobile */
  .book-content {
    width: 95vw;
    max-height: 85vh;
  }
  .book-header { padding: 6px 10px; font-size: 11px; }
  .book-entries { font-size: 10px; padding: 8px; }
}

@media (max-width: 480px) {
  #world {
    font-size: 5.5px;
    line-height: 1.0;
    padding: 1px 2px;
  }

  #scene-container {
    min-height: 30vh;
    max-height: 45vh;
  }

  #sidebar { font-size: 10px; }
  .res-row { font-size: 9px; }
  .info-header { font-size: 11px; letter-spacing: 1px; }
  #bottom-bar { height: 28px; font-size: 9px; }
  #whisper-box { max-width: 140px; }
  #whisper-input { font-size: 9px; padding: 2px 5px; }
}

@media (max-width: 380px) {
  #world {
    font-size: 4.5px;
    line-height: 0.95;
  }
}
